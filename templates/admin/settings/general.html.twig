{% extends 'admin/base.html.twig' %}

{% block title %}Param√®tres G√©n√©raux{% endblock %}

{% block body %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>‚öôÔ∏è Param√®tres G√©n√©raux</h1>
    <div>
        <a href="{{ path('admin_dashboard') }}" class="btn btn-secondary">‚Üê Retour au Dashboard</a>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <form method="post" action="{{ path('admin_settings_update') }}">
            <!-- Contenu du Site -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">üìù Contenu du Site</h5>
                </div>
                <div class="card-body">
                    {% for setting in contentSettings %}
                        <div class="mb-3">
                            <label for="{{ setting.key }}" class="form-label">{{ setting.label }}</label>
                            {% if setting.type == 'textarea' %}
                                <textarea class="form-control" id="{{ setting.key }}" name="{{ setting.key }}" rows="3">{{ setting.value }}</textarea>
                            {% else %}
                                <input type="{{ setting.type }}" class="form-control" id="{{ setting.key }}" name="{{ setting.key }}" value="{{ setting.value }}">
                            {% endif %}
                            {% if setting.description %}
                                <small class="text-muted">{{ setting.description }}</small>
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
            </div>

            <!-- Param√®tres Boutique -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">üõí Param√®tres Boutique</h5>
                </div>
                <div class="card-body">
                    {% for setting in shopSettings %}
                        <div class="mb-3">
                            <label for="{{ setting.key }}" class="form-label">{{ setting.label }}</label>
                            <input type="{{ setting.type }}" class="form-control" id="{{ setting.key }}" name="{{ setting.key }}" value="{{ setting.value }}" {% if setting.type == 'number' %}step="0.01"{% endif %}>
                            {% if setting.description %}
                                <small class="text-muted">{{ setting.description }}</small>
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
            </div>

            <!-- Param√®tres d'Affichage -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">üëÅÔ∏è Param√®tres d'Affichage</h5>
                </div>
                <div class="card-body">
                    {% for setting in displaySettings %}
                        <div class="mb-3">
                            <label for="{{ setting.key }}" class="form-label">{{ setting.label }}</label>
                            {% if setting.type == 'boolean' %}
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input" id="{{ setting.key }}" name="{{ setting.key }}" value="1" {{ setting.value ? 'checked' : '' }}>
                                    <label class="form-check-label" for="{{ setting.key }}">
                                        Activ√©
                                    </label>
                                </div>
                            {% else %}
                                <input type="{{ setting.type }}" class="form-control" id="{{ setting.key }}" name="{{ setting.key }}" value="{{ setting.value }}">
                            {% endif %}
                            {% if setting.description %}
                                <small class="text-muted">{{ setting.description }}</small>
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
            </div>

            <div class="d-flex gap-2">
                <button type="submit" class="btn btn-success">
                    <i class="fa fa-save"></i> Enregistrer les Param√®tres
                </button>
                <button type="button" class="btn btn-warning" onclick="resetDefaults()">
                    <i class="fa fa-refresh"></i> R√©initialiser
                </button>
            </div>
        </form>
    </div>

    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">üí° Aide</h5>
            </div>
            <div class="card-body">
                <h6>Contenu du Site</h6>
                <p class="small text-muted">Modifiez le titre, la description et les informations de contact de votre site.</p>
                
                <h6>Param√®tres Boutique</h6>
                <p class="small text-muted">Configurez la devise, les prix par d√©faut et les seuils de livraison.</p>
                
                <h6>Param√®tres d'Affichage</h6>
                <p class="small text-muted">Contr√¥lez l'affichage des prix, du stock et des avis clients.</p>
                
                <div class="alert alert-info">
                    <small>
                        <i class="fa fa-info-circle"></i>
                        Les modifications sont appliqu√©es imm√©diatement sur le site.
                    </small>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function resetDefaults() {
    if (confirm('√ätes-vous s√ªr de vouloir r√©initialiser tous les param√®tres aux valeurs par d√©faut ?')) {
        fetch('{{ path('admin_settings_reset_defaults') }}', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            }
        }).then(() => {
            location.reload();
        });
    }
}
</script>
{% endblock %}