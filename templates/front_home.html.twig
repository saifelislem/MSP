<!DOCTYPE html>
<html lang="fr">
<head>
	<title>Boutique - Produits Personnalisés</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="icon" type="image/png" href="{{ asset('images/icons/favicon.png') }}"/>
	<link rel="stylesheet" type="text/css" href="{{ asset('vendor/bootstrap/css/bootstrap.min.css') }}">
	<link rel="stylesheet" type="text/css" href="{{ asset('fonts/font-awesome-4.7.0/css/font-awesome.min.css') }}">
	<link rel="stylesheet" type="text/css" href="{{ asset('fonts/iconic/css/material-design-iconic-font.min.css') }}">
	<link rel="stylesheet" type="text/css" href="{{ asset('vendor/animate/animate.css') }}">
	<link rel="stylesheet" type="text/css" href="{{ asset('vendor/css-hamburgers/hamburgers.min.css') }}">
	<link rel="stylesheet" type="text/css" href="{{ asset('vendor/animsition/css/animsition.min.css') }}">
	<link rel="stylesheet" type="text/css" href="{{ asset('vendor/select2/select2.min.css') }}">
	<link rel="stylesheet" type="text/css" href="{{ asset('vendor/perfect-scrollbar/perfect-scrollbar.css') }}">
	<link rel="stylesheet" type="text/css" href="{{ asset('css/util.css') }}">
	<link rel="stylesheet" type="text/css" href="{{ asset('css/main.css') }}">
	<link rel="stylesheet" type="text/css" href="{{ asset('css/cart-sidebar.css') }}">
	<link rel="stylesheet" type="text/css" href="{{ asset('css/custom-theme.css') }}">
	<style>
		/* 5 colonnes sur grand écran */
		@media (min-width: 992px) {
			.col-lg-2-4 {
				flex: 0 0 20%;
				max-width: 20%;
			}
		}
		/* 4 colonnes sur tablette */
		@media (min-width: 768px) and (max-width: 991px) {
			.col-lg-2-4 {
				flex: 0 0 25%;
				max-width: 25%;
			}
		}
		/* 2 colonnes sur mobile */
		@media (max-width: 767px) {
			.col-lg-2-4 {
				flex: 0 0 50%;
				max-width: 50%;
			}
		}
		
		/* Afficher le bouton au survol */
		.product-card:hover .personalize-btn {
			opacity: 1 !important;
		}
		
		/* Sur mobile, toujours afficher le bouton */
		@media (max-width: 767px) {
			.personalize-btn {
				opacity: 1 !important;
			}
		}
	</style>
</head>
<body class="animsition">
	
	<!-- Header -->
	<header class="header-v3" style="background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
		<div class="container-menu-desktop trans-03">
			<div class="wrap-menu-desktop" style="background: white;">
				<nav class="limiter-menu-desktop p-l-45">
					<a href="{{ path('app_home') }}" class="logo" style="text-decoration: none;">
						<div style="display: flex; align-items: center; gap: 5px;">
							<span style="color: #2F4E9B; font-size: 32px; font-weight: bold; letter-spacing: -2px;">MS</span>
							<span style="color: #8A92AD; font-size: 20px; font-weight: 500;">Lettres</span>
						</div>
					</a>

					<div class="menu-desktop">
						<ul class="main-menu">
							<li class="active-menu">
								<a href="{{ path('app_home') }}" style="color: #222;">Accueil</a>
							</li>
							<li>
								<a href="{{ path('app_cart') }}" style="color: #222;">Mon Panier</a>
							</li>
						</ul>
					</div>	

					<div class="wrap-icon-header flex-w flex-r-m h-full">							
						<div class="flex-c-m h-full p-r-25">
							<div class="icon-header-item trans-04 p-lr-11 icon-header-noti js-show-sidebar" data-notify="{{ cartItemsCount|default(0) }}" style="color: #222;">
								<i class="zmdi zmdi-shopping-cart" style="font-size: 24px;"></i>
							</div>
						</div>
						<a href="{{ path('customer_profile') }}" class="icon-header-item trans-04 p-lr-11" title="Mon Profil" style="color: #222;">
							<i class="zmdi zmdi-account-circle" style="font-size: 24px;"></i>
						</a>
					</div>
				</nav>
			</div>	
		</div>

		<!-- Header Mobile -->
		<div class="wrap-header-mobile">
			<div class="logo-mobile">
				<a href="{{ path('app_home') }}"><img src="{{ asset('images/icons/logo-01.png') }}" alt="LOGO"></a>
			</div>

			<div class="wrap-icon-header flex-w flex-r-m h-full m-r-15">
				<div class="flex-c-m h-full p-r-5">
					<div class="icon-header-item cl2 hov-cl1 trans-04 p-lr-11 icon-header-noti js-show-sidebar" data-notify="{{ cartItemsCount|default(0) }}">
						<i class="zmdi zmdi-shopping-cart"></i>
					</div>
				</div>
			</div>

			<div class="btn-show-menu-mobile hamburger hamburger--squeeze">
				<span class="hamburger-box">
					<span class="hamburger-inner"></span>
				</span>
			</div>
		</div>

		<div class="menu-mobile">
			<ul class="main-menu-m">
				<li>
					<a href="{{ path('app_home') }}">Accueil</a>
				</li>
				<li>
					<a href="{{ path('app_cart') }}">Mon Panier</a>
				</li>
			</ul>
		</div>
	</header>

	<!-- Sidebar Panier -->
	{% include 'includes/cart_sidebar.html.twig' %}

	<!-- Section Produits -->
	<section class="bg0 p-t-100 p-b-130">
		<div class="container">
			<div class="p-b-30" style="text-align: center;">
				<h3 class="ltext-103 cl5" style="margin-bottom: 15px; text-align: center;">
					Nos Modèles de Lettres Personnalisées
				</h3>
				<p class="stext-113 cl6" style="margin-top: 0; text-align: center;">
					Choisissez votre modèle et personnalisez-le selon vos besoins
				</p>
			</div>

			<div class="row p-t-40">
				{% if modeles|length > 0 %}
					{% for modele in modeles %}
					<div class="col-sm-6 col-md-4 col-lg-2-4 p-b-35" style="flex: 0 0 20%; max-width: 20%;">
						<div class="block2 product-card" style="border-radius: 12px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: transform 0.3s, box-shadow 0.3s;" onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 8px 25px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.1)'">
							<div class="block2-pic hov-img0" style="position: relative; overflow: hidden;">
								<img src="{{ asset(modele.image) }}" alt="{{ modele.nom }}" style="width: 100%; height: 220px; object-fit: cover; transition: transform 0.3s;">

								<button class="block2-btn stext-103 cl0 trans-04 js-show-modal1 personalize-btn" 
										onclick="openModalWithImage('{{ asset(modele.image) }}', '{{ modele.nom }}')"
										style="position: absolute; bottom: 15px; left: 50%; transform: translateX(-50%); background: #2F4E9B; border: none; color: white; font-weight: 500; box-shadow: 0 4px 15px rgba(47, 78, 155, 0.4); padding: 12px 25px; border-radius: 8px; display: flex; align-items: center; justify-content: center; gap: 8px; opacity: 0; transition: opacity 0.3s ease;">
									<i class="zmdi zmdi-edit"></i> Personnaliser
								</button>
							</div>

							<div class="block2-txt flex-w flex-t p-t-20 p-b-20" style="background: white; text-align: center;">
								<div class="block2-txt-child1 flex-col-l w-full" style="text-align: center; display: flex; flex-direction: column; align-items: center;">
									<span class="stext-104 cl2" style="font-weight: 600; font-size: 16px; display: block; margin-bottom: 8px; text-align: center; color: #0F1A3A;">
										{{ modele.nom }}
									</span>
									<span class="stext-102" style="font-size: 12px; display: block; margin-bottom: 4px; text-align: center; color: #8A92AD;">
										à partir de
									</span>
									<span class="stext-102" style="color: #2F4E9B; font-weight: 700; font-size: 18px; text-align: center; display: block;">
										{{ modele.prixBase|number_format(2) }}€
									</span>
								</div>
							</div>
						</div>
					</div>
					{% endfor %}
				{% else %}
					<div class="col-12 text-center p-t-50 p-b-50">
						<p class="stext-107 cl6">Aucun modèle disponible pour le moment.</p>
					</div>
				{% endif %}
			</div>
		</div>
	</section>

	<!-- Footer -->
	<footer>
		{% include 'includes/footer.html.twig' %}
	</footer>

	<!-- Back to top -->
	<div class="btn-back-to-top" id="myBtn">
		<span class="symbol-btn-back-to-top">
			<i class="zmdi zmdi-chevron-up"></i>
		</span>
	</div>

	<script src="{{ asset('vendor/jquery/jquery-3.2.1.min.js') }}"></script>
	<script src="{{ asset('vendor/animsition/js/animsition.min.js') }}"></script>
	<script src="{{ asset('vendor/bootstrap/js/popper.js') }}"></script>
	<script src="{{ asset('vendor/bootstrap/js/bootstrap.min.js') }}"></script>
	<script src="{{ asset('vendor/select2/select2.min.js') }}"></script>
	<script src="{{ asset('vendor/perfect-scrollbar/perfect-scrollbar.min.js') }}"></script>
	<script src="{{ asset('vendor/sweetalert/sweetalert.min.js') }}"></script>
	<script src="{{ asset('js/main.js') }}"></script>
	<script src="{{ asset('js/cart-functions.js') }}"></script>

	<script>
	// Ouvrir le modal avec l'image sélectionnée
	function openModalWithImage(imageUrl, modeleName) {
		// Réinitialiser tous les champs
		document.getElementById('modal-product-text').value = '';
		document.getElementById('modal-product-largeur').value = '';
		document.getElementById('modal-product-hauteur').value = '';
		document.getElementById('modal-product-typeEcriture').value = 'Arial';
		document.getElementById('modal-product-quantity').value = 1;
		document.getElementById('modal-product-text').removeAttribute('data-product-id');
		
		// Stocker l'image et le nom du modèle pour l'utiliser plus tard
		document.getElementById('modal-product-text').setAttribute('data-image-url', imageUrl);
		document.getElementById('modal-product-text').setAttribute('data-model-name', modeleName);
		
		// Changer l'image dans le modal
		const modalImage = document.querySelector('.js-modal1 .item-slick3 img');
		if (modalImage) {
			modalImage.src = imageUrl;
			modalImage.alt = modeleName;
		}
		
		// Mettre à jour le titre du modal
		const modalTitle = document.getElementById('modal-product-title');
		if (modalTitle) {
			modalTitle.textContent = modeleName;
		}
		
		// Mettre à jour l'aperçu
		updateModalPreview();
	}

	// Ouvrir le modal avec un formulaire vide (pour le bouton "Créer un produit")
	function openEmptyModal() {
		openModalWithImage('/images/product-detail-01.jpg', 'Personnalisez votre produit');
	}

	// Mettre à jour l'aperçu du modal
	function updateModalPreview() {
		const text = document.getElementById('modal-product-text').value || 'Votre texte apparaîtra ici';
		const largeur = document.getElementById('modal-product-largeur').value || '10';
		const hauteur = document.getElementById('modal-product-hauteur').value || '10';
		const font = document.getElementById('modal-product-typeEcriture').value || 'Arial';
		
		document.getElementById('preview-text').textContent = text;
		document.getElementById('preview-text').style.fontFamily = font;
		document.getElementById('preview-dimensions').textContent = `Dimensions: ${largeur}cm × ${hauteur}cm`;
		document.getElementById('preview-font').textContent = `Police: ${font}`;
	}

	// Réinitialiser le formulaire du modal (pour le bouton "Créer un produit")
	function resetModalForm() {
		openEmptyModal();
	}

	// Perfect Scrollbar
	$('.js-pscroll').each(function(){
		$(this).css('position','relative');
		$(this).css('overflow','hidden');
		var ps = new PerfectScrollbar(this, {
			wheelSpeed: 1,
			scrollingThreshold: 1000,
			wheelPropagation: false,
		});

		$(window).on('resize', function(){
			ps.update();
		})
	});
	</script>

	<!-- Modal Product -->
	{% include 'includes/product_modal.html.twig' %}

</body>
</html>
